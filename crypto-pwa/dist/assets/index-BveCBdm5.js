import R from"net";import x from"http";import q from"https";var _={exports:{}},O,k;function L(){if(k)return O;k=1;var a=1e3,u=a*60,d=u*60,n=d*24,m=n*7,g=n*365.25;O=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return C(r);if(t==="number"&&isFinite(r))return e.long?i(r):y(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function C(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return t*g;case"weeks":case"week":case"w":return t*m;case"days":case"day":case"d":return t*n;case"hours":case"hour":case"hrs":case"hr":case"h":return t*d;case"minutes":case"minute":case"mins":case"min":case"m":return t*u;case"seconds":case"second":case"secs":case"sec":case"s":return t*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function y(r){var e=Math.abs(r);return e>=n?Math.round(r/n)+"d":e>=d?Math.round(r/d)+"h":e>=u?Math.round(r/u)+"m":e>=a?Math.round(r/a)+"s":r+"ms"}function i(r){var e=Math.abs(r);return e>=n?o(r,e,n,"day"):e>=d?o(r,e,d,"hour"):e>=u?o(r,e,u,"minute"):e>=a?o(r,e,a,"second"):r+" ms"}function o(r,e,t,s){var c=e>=t*1.5;return Math.round(r/t)+" "+s+(c?"s":"")}return O}var j,E;function z(){if(E)return j;E=1;function a(u){n.debug=n,n.default=n,n.coerce=o,n.disable=y,n.enable=g,n.enabled=i,n.humanize=L(),n.destroy=r,Object.keys(u).forEach(e=>{n[e]=u[e]}),n.names=[],n.skips=[],n.formatters={};function d(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t|=0;return n.colors[Math.abs(t)%n.colors.length]}n.selectColor=d;function n(e){let t,s=null,c,F;function l(...f){if(!l.enabled)return;const b=l,w=Number(new Date),B=w-(t||w);b.diff=B,b.prev=t,b.curr=w,t=w,f[0]=n.coerce(f[0]),typeof f[0]!="string"&&f.unshift("%O");let v=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,(S,D)=>{if(S==="%%")return"%";v++;const A=n.formatters[D];if(typeof A=="function"){const N=f[v];S=A.call(b,N),f.splice(v,1),v--}return S}),n.formatArgs.call(b,f),(b.log||n.log).apply(b,f)}return l.namespace=e,l.useColors=n.useColors(),l.color=n.selectColor(e),l.extend=m,l.destroy=n.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:()=>s!==null?s:(c!==n.namespaces&&(c=n.namespaces,F=n.enabled(e)),F),set:f=>{s=f}}),typeof n.init=="function"&&n.init(l),l}function m(e,t){const s=n(this.namespace+(typeof t>"u"?":":t)+e);return s.log=this.log,s}function g(e){n.save(e),n.namespaces=e,n.names=[],n.skips=[];const t=(typeof e=="string"?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const s of t)s[0]==="-"?n.skips.push(s.slice(1)):n.names.push(s)}function C(e,t){let s=0,c=0,F=-1,l=0;for(;s<e.length;)if(c<t.length&&(t[c]===e[s]||t[c]==="*"))t[c]==="*"?(F=c,l=s,c++):(s++,c++);else if(F!==-1)c=F+1,l++,s=l;else return!1;for(;c<t.length&&t[c]==="*";)c++;return c===t.length}function y(){const e=[...n.names,...n.skips.map(t=>"-"+t)].join(",");return n.enable(""),e}function i(e){for(const t of n.skips)if(C(e,t))return!1;for(const t of n.names)if(C(e,t))return!0;return!1}function o(e){return e instanceof Error?e.stack||e.message:e}function r(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return j=a,j}var M;function W(){return M||(M=1,(function(a,u){var d={};u.formatArgs=m,u.save=g,u.load=C,u.useColors=n,u.storage=y(),u.destroy=(()=>{let o=!1;return()=>{o||(o=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),u.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let o;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(o=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(o[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function m(o){if(o[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+o[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;o.splice(1,0,r,"color: inherit");let e=0,t=0;o[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(e++,s==="%c"&&(t=e))}),o.splice(t,0,r)}u.log=console.debug||console.log||(()=>{});function g(o){try{o?u.storage.setItem("debug",o):u.storage.removeItem("debug")}catch{}}function C(){let o;try{o=u.storage.getItem("debug")||u.storage.getItem("DEBUG")}catch{}return!o&&typeof process<"u"&&"env"in process&&(o=d.DEBUG),o}function y(){try{return localStorage}catch{}}a.exports=z()(u);const{formatters:i}=a.exports;i.j=function(o){try{return JSON.stringify(o)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}})(_,_.exports)),_.exports}var p={},h={},P;function J(){if(P)return h;P=1;var a=h&&h.__createBinding||(Object.create?(function(i,o,r,e){e===void 0&&(e=r);var t=Object.getOwnPropertyDescriptor(o,r);(!t||("get"in t?!o.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,e,t)}):(function(i,o,r,e){e===void 0&&(e=r),i[e]=o[r]})),u=h&&h.__setModuleDefault||(Object.create?(function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}):function(i,o){i.default=o}),d=h&&h.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var r in i)r!=="default"&&Object.prototype.hasOwnProperty.call(i,r)&&a(o,i,r);return u(o,i),o};Object.defineProperty(h,"__esModule",{value:!0}),h.req=h.json=h.toBuffer=void 0;const n=d(x),m=d(q);async function g(i){let o=0;const r=[];for await(const e of i)o+=e.length,r.push(e);return Buffer.concat(r,o)}h.toBuffer=g;async function C(i){const r=(await g(i)).toString("utf8");try{return JSON.parse(r)}catch(e){const t=e;throw t.message+=` (input: ${r})`,t}}h.json=C;function y(i,o={}){const e=((typeof i=="string"?i:i.href).startsWith("https:")?m:n).request(i,o),t=new Promise((s,c)=>{e.once("response",s).once("error",c).end()});return e.then=t.then.bind(t),e}return h.req=y,h}var I;function Z(){return I||(I=1,(function(a){var u=p&&p.__createBinding||(Object.create?(function(r,e,t,s){s===void 0&&(s=t);var c=Object.getOwnPropertyDescriptor(e,t);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,c)}):(function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]})),d=p&&p.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),n=p&&p.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&u(e,r,t);return d(e,r),e},m=p&&p.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&u(e,r,t)};Object.defineProperty(a,"__esModule",{value:!0}),a.Agent=void 0;const g=n(R),C=n(x),y=q;m(J(),a);const i=Symbol("AgentBaseInternalState");class o extends C.Agent{constructor(e){super(e),this[i]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}const{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(s=>s.indexOf("(https.js:")!==-1||s.indexOf("node:https:")!==-1)}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);const t=new g.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||t===null)return;const s=this.sockets[e],c=s.indexOf(t);c!==-1&&(s.splice(c,1),this.totalSocketCount--,s.length===0&&delete this.sockets[e])}getName(e){return this.isSecureEndpoint(e)?y.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,s){const c={...t,secureEndpoint:this.isSecureEndpoint(t)},F=this.getName(c),l=this.incrementSockets(F);Promise.resolve().then(()=>this.connect(e,c)).then(f=>{if(this.decrementSockets(F,l),f instanceof C.Agent)try{return f.addRequest(e,c)}catch(b){return s(b)}this[i].currentSocket=f,super.createSocket(e,t,s)},f=>{this.decrementSockets(F,l),s(f)})}createConnection(){const e=this[i].currentSocket;if(this[i].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[i].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[i]&&(this[i].defaultPort=e)}get protocol(){return this[i].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[i]&&(this[i].protocol=e)}}a.Agent=o})(p)),p}export{Z as a,W as r};
