# å‰ç«¯è°ƒè¯•æŒ‡å— / Frontend Troubleshooting Guide

## ğŸ¯ å½“å‰çŠ¶æ€ / Current Status

å·²æ·»åŠ **å®Œæ•´è°ƒè¯•é¢æ¿**åˆ° Exchange Balances å¡ç‰‡ï¼Œç°åœ¨å¯ä»¥æ¸…æ¥šçœ‹åˆ°é—®é¢˜åŸå› ã€‚

## ğŸ“‹ æ£€æŸ¥æ­¥éª¤ / Inspection Steps

### 1ï¸âƒ£ æ‰“å¼€æµè§ˆå™¨è®¿é—®

```
http://192.168.0.54:3000
```

### 2ï¸âƒ£ è¿›å…¥ Dashboard é¡µé¢

ç‚¹å‡»åº•éƒ¨å¯¼èˆªçš„ Dashboard å›¾æ ‡

### 3ï¸âƒ£ æŸ¥çœ‹ Exchange Balances å¡ç‰‡

ç´«è‰²çš„ "Exchange Balances" å¡ç‰‡ä¼šæ˜¾ç¤ºï¼š

#### ğŸ” è°ƒè¯•ä¿¡æ¯é¢æ¿ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰

è°ƒè¯•é¢æ¿ä¼šæ˜¾ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” è°ƒè¯•ä¿¡æ¯ (Debug Info)

âœ…/âŒ Backend Enabled: true/false
âœ…/âš ï¸ API URL: http://192.168.0.54:3000

åŒæ­¥çŠ¶æ€:
  ğŸŸ¢/ğŸŸ¡ Ready/Syncing...
  Last Sync: 2:30:45 PM

ä½™é¢æ•°æ®:
  Balances Count: 3
  okx/BTC: 0.00118431
  okx/XAUT: 0.02023165
  okx/USDT: 0.09103700

ä»·æ ¼æ•°æ®:
  Prices Count: 100+
  BTC:$50000, ETH:$3000...

æ£€æŸ¥æ¸…å•:
  âœ… VITE_USE_BACKEND = true
  âœ… VITE_API_BASE_URL å·²è®¾ç½®
  âœ… æ”¶åˆ°ä½™é¢æ•°æ®
  âœ… æ— é”™è¯¯

ğŸ’¡ æç¤º: æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°(F12)æŸ¥çœ‹ [ExchangeSync] æ—¥å¿—
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 4ï¸âƒ£ æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰

æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[ExchangeSync] ğŸš€ å¼€å§‹åŒæ­¥ | Starting sync...
[ExchangeSync] ç¯å¢ƒé…ç½®:
  - USE_BACKEND: true
  - API_BASE_URL: http://192.168.0.54:3000
[ExchangeSync] å‡†å¤‡è·å–äº¤æ˜“æ‰€: ['okx']
[ExchangeSync] ğŸŒ è¯·æ±‚ okx ä½™é¢:
  å®Œæ•´URL: http://192.168.0.54:3000/api/exchange/okx/balance
[ExchangeSync] ğŸ“¡ å“åº”çŠ¶æ€: 200 OK
[ExchangeSync] ğŸ“¦ æ”¶åˆ°æ•°æ®: {success: true, exchange: "okx", count: 3, ...}
[ExchangeSync] âœ… okx: 3 ä¸ªèµ„äº§
  [1] XAUT: 0.02023165 (free: 0.02023165, used: 0)
  [2] BTC: 0.00118431 (free: 0.00118431, used: 0)
  [3] USDT: 0.09103700 (free: 0.09103700, used: 0)
[ExchangeSync] æ·»åŠ äº† 3 æ¡ä½™é¢è®°å½•
[ExchangeSync] ğŸ“Š æ€»è®¡ä½™é¢æ•°: 3
[ExchangeSync] âœ… åŒæ­¥å®Œæˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

## ğŸ”´ å¸¸è§é—®é¢˜è¯Šæ–­ / Common Issues

### é—®é¢˜ 1: Backend Enabled æ˜¾ç¤º âŒ false

**åŸå› **: VITE_USE_BACKEND ç¯å¢ƒå˜é‡æœªè®¾ç½®æˆ–ä¸º false

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ .env æ–‡ä»¶
cat crypto-pwa/.env

# ç¡®ä¿æœ‰è¿™ä¸€è¡Œ
VITE_USE_BACKEND=true

# å¦‚æœä¿®æ”¹äº†ï¼Œéœ€è¦é‡æ–°æ„å»º
cd crypto-pwa
npm run build
```

### é—®é¢˜ 2: API URL æ˜¾ç¤º (empty - using relative)

**åŸå› **: VITE_API_BASE_URL ç¯å¢ƒå˜é‡ä¸ºç©º

**å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ**:
- å¦‚æœæ˜¯åŒä¸€å°æœåŠ¡å™¨ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„ä¹Ÿå¯ä»¥å·¥ä½œ
- å¦‚æœè·¨è®¾å¤‡ï¼Œå¿…é¡»è®¾ç½®å®Œæ•´ URLï¼š
  ```
  VITE_API_BASE_URL=http://192.168.0.54:3000
  ```

### é—®é¢˜ 3: Balances Count: 0 ä¸”æ˜¾ç¤º "âš ï¸ æ²¡æœ‰ä½™é¢æ•°æ®"

**æ£€æŸ¥æ­¥éª¤**:

1. **åç«¯æ˜¯å¦è¿è¡Œï¼Ÿ**
   ```bash
   curl http://192.168.0.54:3000/api/exchange/okx/balance
   ```
   åº”è¯¥è¿”å› JSON æ•°æ®

2. **OKX API Key æ˜¯å¦å·²ä¿å­˜ï¼Ÿ**
   æ£€æŸ¥ `crypto-backend/database.json`ï¼š
   ```json
   {
     "apiKeys": {
       "okx": {
         "apiKey": "...",
         "secret": "...",
         "password": "..."
       }
     }
   }
   ```

3. **æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ï¼Ÿ**
   - CORS é”™è¯¯ï¼Ÿæ£€æŸ¥åç«¯ CORS é…ç½®
   - Network é”™è¯¯ï¼Ÿæ£€æŸ¥ç½‘ç»œè¿æ¥
   - HTTP 4xx/5xxï¼Ÿæ£€æŸ¥åç«¯æ—¥å¿—

### é—®é¢˜ 4: æ§åˆ¶å°æ˜¾ç¤º "âŒ HTTPé”™è¯¯ okx: 500"

**åŸå› **: åç«¯ API è°ƒç”¨å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥åç«¯æ—¥å¿—
cd crypto-backend
# æŸ¥çœ‹åç«¯æ§åˆ¶å°è¾“å‡º

# æµ‹è¯•åç«¯ API
node test-backend-okx.js http://192.168.0.54:3000

# æµ‹è¯• OKX è¿æ¥
node test-okx.js
```

### é—®é¢˜ 5: æ§åˆ¶å°æ˜¾ç¤º "âŒ åŒæ­¥å¤±è´¥: Failed to fetch"

**åŸå› **: ç½‘ç»œè¿æ¥é—®é¢˜æˆ– CORS é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥ç½‘ç»œè¿æ¥**:
   ```bash
   curl http://192.168.0.54:3000/
   ```

2. **æ£€æŸ¥ CORS è®¾ç½®** (crypto-backend/server.js):
   ```javascript
   app.use(cors({
     origin: '*',  // æˆ–æŒ‡å®šå‰ç«¯ URL
     credentials: true
   }));
   ```

3. **æ£€æŸ¥é˜²ç«å¢™**:
   - Windows Defender é˜²ç«å¢™æ˜¯å¦å…è®¸ç«¯å£ 3000

## ğŸ“± è°ƒè¯•é¢æ¿æ§åˆ¶

ç‚¹å‡»å³ä¸Šè§’çš„ **â„¹ï¸** å›¾æ ‡å¯ä»¥ï¼š
- æ˜¾ç¤º/éšè—è°ƒè¯•é¢æ¿
- è°ƒè¯•é¢æ¿é»˜è®¤æ˜¾ç¤ºï¼Œç¡®è®¤ä¸€åˆ‡æ­£å¸¸åå¯éšè—

## âœ… é¢„æœŸçš„æ­£å¸¸çŠ¶æ€

å½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

1. **è°ƒè¯•é¢æ¿æ˜¾ç¤º**:
   - âœ… Backend Enabled: true
   - âœ… API URL: http://192.168.0.54:3000
   - ğŸŸ¢ Ready
   - Balances Count: 3
   - âœ…âœ…âœ…âœ… æ‰€æœ‰æ£€æŸ¥é¡¹é€šè¿‡

2. **ä½™é¢å¡ç‰‡æ˜¾ç¤º**:
   - OKX 3 assets
   - BTC: 0.00118431 ($XX.XX)
   - XAUT: 0.02023165 ($XX.XX)
   - USDT: 0.09103700 ($XX.XX)
   - Total Value: $XXX.XX

3. **æ§åˆ¶å°æ—¥å¿—**:
   - æ¯ 5 ç§’ä¸€æ¬¡åŒæ­¥
   - âœ… æˆåŠŸæ ‡è®°
   - æ— é”™è¯¯ä¿¡æ¯

## ğŸ†˜ ä»ç„¶æœ‰é—®é¢˜ï¼Ÿ

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ£€æŸ¥äº†è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **è°ƒè¯•é¢æ¿æˆªå›¾**
2. **æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—**ï¼ˆå®Œæ•´çš„ [ExchangeSync] æ—¥å¿—ï¼‰
3. **Network æ ‡ç­¾æˆªå›¾**ï¼ˆF12 -> Network -> æ‰¾åˆ° balance è¯·æ±‚ï¼‰
4. **åç«¯æ§åˆ¶å°æ—¥å¿—**

## ğŸ”§ æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤

```bash
# 1. æµ‹è¯•åç«¯æ˜¯å¦è¿è¡Œ
curl http://192.168.0.54:3000/

# 2. æµ‹è¯• OKX API ç«¯ç‚¹
curl http://192.168.0.54:3000/api/exchange/okx/balance

# 3. æµ‹è¯•å®Œæ•´æµç¨‹
cd crypto-backend
node test-complete-flow.js

# 4. æµ‹è¯• OKX API å‡­è¯
node test-okx.js
```

## ğŸ“ é‡æ–°æ„å»ºå’Œéƒ¨ç½²

å¦‚æœä¿®æ”¹äº† .env æ–‡ä»¶ï¼š

```powershell
# 1. é‡æ–°æ„å»ºå‰ç«¯
cd C:\Users\hosha\Documents\GitHub\CryptoPrice\crypto-pwa
npm run build

# 2. éƒ¨ç½²åˆ°åç«¯
Copy-Item -Path "dist\*" -Destination "..\crypto-backend\public\" -Recurse -Force

# 3. å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨
# Ctrl + Shift + R (Windows/Linux)
# Cmd + Shift + R (Mac)
```
